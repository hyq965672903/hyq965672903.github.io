---
title: JVM与GC调优(三)-内存结构篇
index_img: /img/default.png
banner_img: /img/default.png
date: 2022-09-25 13:08:54
tags:
categories:
description:

---

了解内存结构中相关信息，程序计数器、虚拟器栈、本地方法和本地接口栈、堆、方法区

<!-- more -->

## 程序计数器（Program Counter Register）

> PC 寄存器用来存储指向下一条指令的地址，也即将要执行的指令代码

- 它是一块很小的内存空间，几乎可以忽略不记。也是运算速度最快的存储区域。

- 在 JVM 规范中，每个线程都有它自己的程序计数器，是线程私有的，生命周期与线程的生命周期保持一致。

- 任何时间一个线程都只有一个方法在执行，也就是所谓的**当前方法**。程序计数器会存储当前线程正在执行的 Java 方法的 JVM 指令地址；或者，如果是在执行 native方法，则是未指定值（undefined）（因为PC寄存器是java层面的，本地方法栈是C/C++层面的）。

- 它是程序控制流的指示器，分支、循环、跳转、异常处理、线程恢复等基础功能都需要依赖这个计数器来完成；

- 字节码解释器工作时就是通过改变这个计数器的值来选取下一条需要执行的字节码指令；

- 它是唯一一个在 Java 虚拟机规范中没有规定任何 OutOfMemoryError 情况的区域。

### 为什么要设置成 线程私有的 ？

CPU需要不停的切换线程，在切换回来的时候，A线程的PC寄存器里就记录了 A线程执行到哪里了 B线程的PC寄存器里就记录了 B线程执行到哪里了，所以需要 是线程私有的。

## 栈的理解

